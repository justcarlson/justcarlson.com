---
phase: 02-components
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/StructuredData.astro
autonomous: true

must_haves:
  truths:
    - "BlogPosting schema shows Justin Carlson as author"
    - "Person schema shows justcarlson.com identity"
    - "WebSite schema references justcarlson.com domain"
    - "No hardcoded steipete or Peter Steinberger references in structured data"
  artifacts:
    - path: "src/components/StructuredData.astro"
      provides: "Schema.org JSON-LD for SEO"
      contains: "SITE.author"
  key_links:
    - from: "src/components/StructuredData.astro"
      to: "src/consts.ts"
      via: "import { SITE, SOCIAL_LINKS }"
      pattern: "import.*SITE.*from.*consts"
---

<objective>
Update StructuredData.astro to consume SITE config values instead of hardcoded Peter Steinberger references.

Purpose: Structured data (JSON-LD) is what Google and other search engines read to understand site authorship and content. Currently shows Peter's identity in search results.

Output: StructuredData.astro consuming SITE.author, SITE.website, SITE.desc, and SOCIAL_LINKS from consts.ts
</objective>

<execution_context>
@/home/jc/.claude/get-shit-done/workflows/execute-plan.md
@/home/jc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-components/02-CONTEXT.md
@.planning/phases/02-components/02-RESEARCH.md

# Key source files
@src/consts.ts
@src/components/StructuredData.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Refactor StructuredData.astro to use config values</name>
  <files>src/components/StructuredData.astro</files>
  <action>
Rewrite StructuredData.astro to import and use SITE and SOCIAL_LINKS from consts.ts:

1. Add imports at top of frontmatter:
   ```typescript
   import { SITE, SOCIAL_LINKS } from "@/consts";
   ```

2. Update BlogPosting schema:
   - author.name: `data.author || SITE.author`
   - author.url: `SITE.profile`
   - publisher.name: `SITE.author`
   - publisher.logo.url: `new URL("/avatar.jpg", SITE.website).href` (or appropriate avatar path)
   - image fallback: `new URL("/og.png", SITE.website).href`

3. Update Person schema:
   - name: `SITE.author`
   - url: `SITE.website`
   - image: `new URL("/avatar.jpg", SITE.website).href`
   - sameAs: `SOCIAL_LINKS.filter(s => s.label !== "RSS").map(s => s.href)`
   - description: `SITE.desc`

4. Update WebSite schema:
   - name: `SITE.author`
   - url: `SITE.website`
   - description: `SITE.desc`
   - author.name: `SITE.author`
   - potentialAction.target: Template with `${SITE.website}search?q={search_term_string}`

Remove ALL hardcoded references:
- "Peter Steinberger"
- "steipete.me"
- "steipete"
- "peter-avatar.jpg"
- Any social URLs (github.com/steipete, twitter.com/steipete, etc.)

Keep using JSON.stringify() with set:html for XSS safety.
  </action>
  <verify>
Run: `rg -i "steipete|peter" src/components/StructuredData.astro`
Should return no matches.

Run: `rg "SITE\." src/components/StructuredData.astro`
Should show multiple config references.
  </verify>
  <done>
StructuredData.astro uses SITE.author, SITE.website, SITE.profile, SITE.desc, and SOCIAL_LINKS from consts.ts. Zero hardcoded identity references remain.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify structured data renders correctly</name>
  <files>src/components/StructuredData.astro</files>
  <action>
Run the dev server and verify structured data output:

1. Start dev server: `npm run dev`
2. Open browser to http://localhost:4321
3. View page source (Ctrl+U)
4. Find `<script type="application/ld+json">` blocks
5. Verify:
   - WebSite schema shows "Justin Carlson" and justcarlson.com
   - Person schema (on about page if present) shows correct identity
   - No steipete/Peter references in any JSON-LD

If build fails, fix TypeScript errors before proceeding.
  </action>
  <verify>
Run: `npm run build`
Build should complete without errors.

Check output for structured data:
`rg -A5 "application/ld\+json" dist/index.html 2>/dev/null || echo "Run npm run build first"`
  </verify>
  <done>
Build passes. Structured data JSON-LD in built HTML shows Justin Carlson identity.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Grep verification (no old references):
   ```bash
   rg -i "steipete|peter steinberger" src/components/StructuredData.astro
   ```
   Expected: No matches

2. Config usage verification:
   ```bash
   rg "SITE\." src/components/StructuredData.astro
   ```
   Expected: Multiple matches showing config consumption

3. Build verification:
   ```bash
   npm run build
   ```
   Expected: Build succeeds without errors
</verification>

<success_criteria>
- StructuredData.astro imports SITE and SOCIAL_LINKS from consts.ts
- All three schema types (BlogPosting, Person, WebSite) use config values
- Zero hardcoded steipete/Peter references remain in the component
- Build passes successfully
</success_criteria>

<output>
After completion, create `.planning/phases/02-components/02-01-SUMMARY.md`
</output>
