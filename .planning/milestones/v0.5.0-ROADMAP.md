# Milestone v0.5.0: Graceful Fallback for Blocked Services

**Status:** ✅ SHIPPED 2026-02-02
**Phases:** 20-22
**Total Plans:** 5

## Overview

This milestone delivered graceful degradation when external services (Gravatar, analytics, GitHub chart) are blocked by privacy tools or network restrictions. The site loads fully without external dependencies, with external content enhancing the experience when available.

## Phases

### Phase 20: Configuration Foundation

**Goal:** Infrastructure enables proxied Gravatar and updated security headers
**Depends on:** Nothing (first phase of milestone)
**Requirements:** CONFIG-01, CONFIG-02
**Plans:** 2 plans

Plans:
- [x] 20-01-PLAN.md — Vercel Image Optimization config and CSS loading/fallback styles
- [x] 20-02-PLAN.md — Playwright testing infrastructure for image blocking verification

**Success Criteria:**
1. ✓ vercel.json contains images.remotePatterns for gravatar.com
2. ✓ CSP headers allow img-src from /_vercel/image endpoint
3. ✓ Production build succeeds with new configuration

### Phase 21: Avatar Fallback

**Goal:** Avatar loads reliably regardless of Gravatar availability
**Depends on:** Phase 20
**Requirements:** IMG-01, IMG-02
**Plans:** 1 plan

Plans:
- [x] 21-01-PLAN.md — Avatar proxy URL with onerror fallback and Playwright tests

**Success Criteria:**
1. ✓ Homepage avatar uses Vercel Image Optimization proxy URL
2. ✓ When proxy fails, local fallback image displays
3. ✓ No layout shift when fallback triggers
4. ✓ Avatar renders correctly in both light and dark themes

### Phase 22: External Resilience

**Goal:** All external images and scripts fail gracefully without breaking page
**Depends on:** Phase 21
**Requirements:** IMG-03, IMG-04, SCRIPT-01, SCRIPT-02, SCRIPT-03
**Plans:** 2 plans

Plans:
- [x] 22-01-PLAN.md — GitHub chart fallback, Analytics error handling, conditional Twitter widget
- [x] 22-02-PLAN.md — Fix GitHub chart disappearing when image cached (gap closure)

**Success Criteria:**
1. ✓ GitHub chart shows link fallback when image blocked
2. ✓ No broken image icons appear anywhere on site
3. ✓ Analytics scripts fail silently without console errors
4. ✓ Page loads completely with all external scripts blocked
5. ✓ No external script blocks page rendering

---

## Milestone Summary

**Key Decisions:**
- CSP img-src uses 'self' data: blob: only — forces external images through Vercel proxy
- Console.log for analytics failures (not completely silent) per user preference
- GitHub chart uses 5s timeout + img.complete check for cached image handling
- Avatar uses explicit dimensions to prevent layout shift

**Issues Resolved:**
- GitHub chart disappearing after 5s when cached (22-02 gap closure)
- MDX script syntax incompatibility (created GitHubChart.astro component)

**Issues Deferred:**
- GitHub chart Vercel proxy optimization (config exists but direct URL used, fallback works)

**Technical Debt:**
- GitHub chart could use Vercel proxy for additional privacy benefit (non-critical)

---

_For current project status, see .planning/ROADMAP.md_
_Archived: 2026-02-02 as part of v0.5.0 milestone completion_
